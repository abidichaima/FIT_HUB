{% extends "baseBack.html.twig" %}

{% block body %}
<div class="col-lg-12 grid-margin stretch-card">
    <div class="card">
        <div class="card-body">
            <h4 class="card-title">Pack</h4>
            <div class="table-responsive">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Nom Pack</th>
                            <th>Prix Pack</th>
                            <th>Duree Pack</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                    {% for pack in packs %}
                        <tr>
                            <td>{{ pack.id }}</td>
                            <td>{{ pack.nomPack }}</td>
                            <td>{{ pack.prixPack }}</td>
                            <td>{{ pack.dureePack }}</td>
                            <td>
                                <button class="btn btn-primary mr-2"><a href="{{ path('PDF_pack', {'id': pack.id}) }}">PDF</a></button>
                                <button class="btn btn-primary mr-2"><a href="{{ path('app_pack_show', {'id': pack.id}) }}">Show</a></button>
                                <button class="btn btn-primary mr-2"><a href="{{ path('app_pack_edit', {'id': pack.id}) }}">Edit</a></button>
                            </td>
                        </tr>
                    {% else %}
                        <tr>
                            <td colspan="5">no records found</td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
                <br>
                <div align="center">
                    <button class="btn btn-primary mr-2"><a href="{{ path('app_pack_new') }}">Create new</a></button>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="col-lg-12 grid-margin stretch-card">
    <div class="card">
        <div class="card-body">
            <h4 class="card-title">Prix des Packs</h4>
            <canvas id="myChart" style="width:100%;max-width:900px"></canvas>
        </div>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>
<script>
let packNames = [];
let packPrices = [];

{% for pack in packs %}
    packNames.push("{{ pack.nomPack }}");
    packPrices.push("{{ pack.prixPack }}");
{% endfor %}

// Fonction pour générer des couleurs aléatoires
function getRandomColor() {
    var letters = '0123456789ABCDEF';
    var color = '#';
    for (var i = 0; i < 6; i++) {
        color += letters[Math.floor(Math.random() * 15)];
    }
    return color;
}


// Création des données pour le graphique
let chartData = {
    labels: packNames,
    datasets: [{
        data: packPrices,
        backgroundColor: packNames.map(name => getRandomColor())
    }]
};

// Configuration des options du graphique
let chartOptions = {
    legend: { display: false },
    title: {
        display: true,
        text: "Prix des Packs"
    },
    scales: {
        yAxes: [{
            ticks: {
                beginAtZero: true
            }
        }]
    }
    
};

// Création du graphique
let ctx = document.getElementById('myChart').getContext('2d');
let myChart = new Chart(ctx, {
    type: 'bar',
    data: chartData,
    options: chartOptions
});
</script>
{% endblock %}